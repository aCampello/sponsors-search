<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.16.0/umd/popper.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
    <title>Companies search</title>

</head>
<script type="text/javascript">
// Search


    function myFunction() {
         let searched = $('#inputSearch').val().toLowerCase();
         $('.alert').hide()
         $('#tableOfResults > tbody').empty();

          $('#tableRow').attr('class', 'row');

          results = 0

          for (company of data) {
          if (results > 10) {
                break;
            }
            if (company['Organisation Name'].toLowerCase().includes(searched)) {
                content = '<tr>' + '<td>' + company['Organisation Name'] + '</td>' +
               '<td>' + company['Town/City'] + '</td>' + '<td>' + company['Type & Rating'].replace('\n','<br>') + '</td>'
                + '<td>' + company['Route'].replace('\n','<br>') + '</td>'
               +'</tr>'
                $('#tableOfResults > tbody').append(content)
                results++;
            }

          }
          if (results > 10) {
            $('.alert').show()
          }
          return false;
     }

</script>
<script type="text/javascript" src="https://antonio-campello-website-resources.s3.eu-west-2.amazonaws.com/data.js"></script>

<style>
    html, body{
      height: 100%;
    }
</style>

<body>
<div class="container">
    <div class="row h-100 m-5">
        <div class="col-md-12 col-12">

            <form id="searchForm" onsubmit="return myFunction()">
                <div class="form-group row">


                    <div class="col-md-10 col-12">
                        <h3>Register of Licensed Sponsors Search</h3>
                        <text class="text-muted"><br>Full data: <a href="https://antonio-campello-website-resources.s3.eu-west-2.amazonaws.com/sponsors.csv">csv</a>,
                            <a href="https://antonio-campello-website-resources.s3.eu-west-2.amazonaws.com/sponsors.json">json</a>, <a href="https://www.gov.uk/government/publications/register-of-licensed-sponsors-workers">source (pdf)</a>.<br />
                            Data is derived from the <a href="https://www.gov.uk/government/publications/register-of-licensed-sponsors-workers">official registry</a>, licensed with <a href="http://www.nationalarchives.gov.uk/doc/open-government-licence/version/3/">Open Government Licence 3.0</a><br>
                        </text>
                    </div>

                    <div class="col-md-2 col-2">

                    </div>
                </div>
                <div class="form-group row">


                    <div class="col-md-8 col-8">
                        <input type="text" class="form-control" id="inputSearch" placeholder="Company Name">
                    </div>

                    <div class="col-md-2 col-2">
                        <button id="submit" type="submit" class="btn btn-primary">Search</button>
                    </div>
                </div>
            </form>
            <div class="row d-none" id="tableRow">
                <div class="table-responsive">

                <div class="col-md-12 col-12">
                <div class="alert alert-danger" role="alert">
                    Too many results. Try to narrow down your search.
                </div>

                    <table class="table" id="tableOfResults">
                    <thead>
                    <tr>
                        <th scope="col">Company name</th>
                        <th scope="col">Location</th>
                        <th scope="col">Types of Visa</th>
                        <th scope="col">Route</th>

                    </tr>
                    </thead>
                    <tbody>

                    </tbody>
                </table>
                </div>
        </div>

    </div>
</div>

</body>
</html>
